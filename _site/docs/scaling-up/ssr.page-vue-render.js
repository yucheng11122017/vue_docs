
    var pageVueRenderFn = function anonymous(
) {
with(this){return _c('div',{attrs:{"id":"app"}},[_c('header',{attrs:{"sticky":""}},[_c('navbar',{attrs:{"type":"dark"},scopedSlots:_u([{key:"right",fn:function(){return [_c('li',[_c('form',{staticClass:"navbar-form"},[_c('searchbar',{attrs:{"data":searchData,"placeholder":"Search","on-hit":searchCallback,"menu-align-right":""}})],1)])]},proxy:true}])},[_c('dropdown',{staticClass:"nav-link",scopedSlots:_u([{key:"header",fn:function(){return [_v("Essentials")]},proxy:true}])},[_v(" "),_c('li',[_c('a',{staticClass:"dropdown-item",attrs:{"href":"/docs/essentials/application.html"}},[_v("Creating an Application")])])])],1)],1),_v(" "),_c('div',{attrs:{"id":"flex-body"}},[_c('overlay-source',{attrs:{"id":"site-nav","tag-name":"nav","to":"site-nav"}},[_c('div',{staticClass:"site-nav-top"},[_c('div',{staticClass:"fw-bold mb-2",staticStyle:{"font-size":"1.25rem"}},[_v("Template")])]),_v(" "),_c('div',{staticClass:"nav-component slim-scroll"},[_c('site-nav',[_c('overlay-source',{staticClass:"site-nav-list site-nav-list-root",attrs:{"tag-name":"ul","to":"mb-site-nav"}},[_c('li',{staticClass:"site-nav-custom-list-item site-nav-list-item-0"},[_v("Getting Started")]),_v(" "),_c('li',[_c('div',{staticClass:"site-nav-default-list-item site-nav-list-item-0",attrs:{"onclick":"handleSiteNavClick(this)"}},[_v("Essentials \n\n"),_c('i',{staticClass:"site-nav-dropdown-btn-icon site-nav-rotate-icon",attrs:{"onclick":"handleSiteNavClick(this.parentNode, false); event.stopPropagation();"}},[_c('span',{staticClass:"glyphicon glyphicon-menu-down",attrs:{"aria-hidden":"true"}})])]),_c('ul',{staticClass:"site-nav-dropdown-container site-nav-dropdown-container-open site-nav-list"},[_c('li',[_c('div',{staticClass:"site-nav-default-list-item site-nav-list-item-1",attrs:{"onclick":"handleSiteNavClick(this)"}},[_c('a',{attrs:{"href":"/docs/essentials/application.html"}},[_v("Creating an Application")])])])])]),_v(" "),_c('li',{staticClass:"site-nav-custom-list-item site-nav-list-item-0"},[_v("Components In-Depth")]),_v(" "),_c('li',{staticClass:"site-nav-custom-list-item site-nav-list-item-0"},[_v("Reusability")]),_v(" "),_c('li',{staticClass:"site-nav-custom-list-item site-nav-list-item-0"},[_v("Built-in Components")]),_v(" "),_c('li',[_c('div',{staticClass:"site-nav-default-list-item site-nav-list-item-0",attrs:{"onclick":"handleSiteNavClick(this)"}},[_v("Scaling Up\n\n"),_c('i',{staticClass:"site-nav-dropdown-btn-icon",attrs:{"onclick":"handleSiteNavClick(this.parentNode, false); event.stopPropagation();"}},[_c('span',{staticClass:"glyphicon glyphicon-menu-down",attrs:{"aria-hidden":"true"}})])]),_c('ul',{staticClass:"site-nav-dropdown-container site-nav-list"},[_c('li',[_c('div',{staticClass:"site-nav-default-list-item site-nav-list-item-1",attrs:{"onclick":"handleSiteNavClick(this)"}},[_c('a',{attrs:{"href":"/docs/scaling-up/sfc.html"}},[_v("Single-file Components")])])]),_v(" "),_c('li',[_c('div',{staticClass:"site-nav-default-list-item site-nav-list-item-1",attrs:{"onclick":"handleSiteNavClick(this)"}},[_c('a',{attrs:{"href":"/docs/scaling-up/tooling.html"}},[_v("Tooling")])])]),_v(" "),_c('li',[_c('div',{staticClass:"site-nav-default-list-item site-nav-list-item-1",attrs:{"onclick":"handleSiteNavClick(this)"}},[_c('a',{attrs:{"href":"/docs/scaling-up/routing.html"}},[_v("Routing")])])]),_v(" "),_c('li',[_c('div',{staticClass:"site-nav-default-list-item site-nav-list-item-1",attrs:{"onclick":"handleSiteNavClick(this)"}},[_c('a',{attrs:{"href":"/docs/scaling-up/state-management.html"}},[_v("State Management")])])]),_v(" "),_c('li',[_c('div',{staticClass:"site-nav-default-list-item site-nav-list-item-1",attrs:{"onclick":"handleSiteNavClick(this)"}},[_c('a',{attrs:{"href":"/docs/scaling-up/testing.html"}},[_v("Testing")])])]),_v(" "),_c('li',[_c('div',{staticClass:"site-nav-default-list-item site-nav-list-item-1",attrs:{"onclick":"handleSiteNavClick(this)"}},[_c('a',{attrs:{"href":"/docs/scaling-up/ssr.html"}},[_v("Server-Side Rendering (SSR)")])])])])]),_v(" "),_c('li',{staticClass:"site-nav-custom-list-item site-nav-list-item-0"},[_v("Best Practices")]),_v(" "),_c('li',{staticClass:"site-nav-custom-list-item site-nav-list-item-0"},[_v("TypeScript")]),_v(" "),_c('li',{staticClass:"site-nav-custom-list-item site-nav-list-item-0"},[_v("Extra Topics")])])],1)],1)]),_v(" "),_c('div',{attrs:{"id":"content-wrapper"}},[_m(0),_v(" "),_c('hr'),_v(" "),_m(1),_v(" "),_m(2),_v(" "),_c('p',[_v("Vue.js is a framework for building client-side applications. By default, Vue components produce and manipulate DOM in the browser as output. However, it is also possible to render the same components into HTML strings on the server, send them directly to the browser, and finally \"hydrate\" the static markup into a fully interactive app on the client.")]),_v(" "),_m(3),_v(" "),_m(4),_v(" "),_c('p',[_v("Compared to a client-side Single-Page Application (SPA), the advantage of SSR primarily lies in:")]),_v(" "),_c('ul',[_m(5),_v(" "),_m(6),_v(" "),_c('li',[_m(7),_v(" "),_c('box',{attrs:{"type":"info"}},[_v("\n  As of now, Google and Bing can index synchronous JavaScript applications just fine. Synchronous being the key word there. If your app starts with a loading spinner, then fetches content via Ajax, the crawler will not wait for you to finish. This means if you have content fetched asynchronously on pages where SEO is important, SSR might be necessary.\n")])],1)]),_v(" "),_c('p',[_v("There are also some trade-offs to consider when using SSR:")]),_v(" "),_m(8),_v(" "),_c('p',[_v("Before using SSR for your app, the first question you should ask is whether you actually need it. It mostly depends on how important time-to-content is for your app. For example, if you are building an internal dashboard where an extra few hundred milliseconds on initial load doesn't matter that much, SSR would be an overkill. However, in cases where time-to-content is absolutely critical, SSR can help you achieve the best possible initial load performance.")]),_v(" "),_m(9),_v(" "),_m(10),_v(" "),_m(11),_v(" "),_m(12),_v(" "),_c('hr'),_v(" "),_m(13),_v(" "),_m(14),_v(" "),_c('p',[_v("Let's take a look at the most bare-bones example of Vue SSR in action.")]),_v(" "),_m(15),_v(" "),_m(16),_c('p',[_v("Then run:")]),_v(" "),_m(17),_c('p',[_v("It should print the following to the command line:")]),_v(" "),_m(18),_m(19),_v(" "),_m(20),_v(" "),_m(21),_v(" "),_m(22),_m(23),_v(" "),_m(24),_v(" "),_m(25),_v(" "),_c('p',[_v("If you click the button, you'll notice the number doesn't change. The HTML is completely static on the client since we are not loading Vue in the browser.")]),_v(" "),_m(26),_v(" "),_m(27),_v(" "),_m(28),_m(29),_v(" "),_c('p',[_v("Notice how we need to reuse the same app implementation as on the server. This is where we need to start thinking about code structure in an SSR app - how do we share the same application code between the server and the client?")]),_v(" "),_m(30),_v(" "),_m(31),_m(32),_v(" "),_c('p',[_v("Our client entry imports the universal code, creates the app, and performs the mount:")]),_v(" "),_m(33),_c('p',[_v("And the server uses the same app creation logic in the request handler:")]),_v(" "),_m(34),_c('p',[_v("In addition, in order to load the client files in the browser, we also need to:")]),_v(" "),_m(35),_v(" "),_m(36),_v(" "),_c('hr'),_v(" "),_m(37),_v(" "),_c('p',[_v("Moving from the example to a production-ready SSR app involves a lot more. We will need to:")]),_v(" "),_c('ul',[_c('li',[_c('p',[_v("Support Vue SFCs and other build step requirements. In fact, we will need to coordinate two builds for the same app: one for the client, and one for the server.")]),_v(" "),_c('box',{attrs:{"type":"info"}},[_v("\n  Vue components are compiled differently when used for SSR - templates are compiled into string concatenations instead of Virtual DOM render functions for more efficient rendering performance.\n")])],1),_v(" "),_m(38),_v(" "),_m(39)]),_v(" "),_c('p',[_v("A complete implementation would be quite complex and depends on the build toolchain you have chosen to work with. Therefore, we highly recommend going with a higher-level, opinionated solution that abstracts away the complexity for you. Below we will introduce a few recommended SSR solutions in the Vue ecosystem.")]),_v(" "),_m(40),_v(" "),_m(41),_v(" "),_m(42),_v(" "),_m(43),_v(" "),_m(44),_v(" "),_m(45),_v(" "),_m(46),_v(" "),_c('hr'),_v(" "),_m(47),_v(" "),_c('p',[_v("Regardless of your build setup or higher-level framework choice, there are some principles that apply in all Vue SSR applications.")]),_v(" "),_m(48),_v(" "),_c('p',[_v("During SSR, each request URL maps to a desired state of our application. There is no user interaction and no DOM updates, so reactivity is unnecessary on the server. By default, reactivity is disabled during SSR for better performance.")]),_v(" "),_m(49),_v(" "),_m(50),_v(" "),_m(51),_v(" "),_m(52),_v(" "),_m(53),_v(" "),_m(54),_v(" "),_m(55),_v(" "),_m(56),_v(" "),_m(57),_v(" "),_m(58),_v(" "),_m(59),_v(" "),_m(60),_v(" "),_c('p',[_v("We can technically re-initialize all the JavaScript modules on each request, just like we do in browsers. However, initializing JavaScript modules can be costly, so this would significantly affect server performance.")]),_v(" "),_m(61),_v(" "),_m(62),_m(63),_v(" "),_m(64),_v(" "),_c('p',[_v("If the DOM structure of the pre-rendered HTML does not match the expected output of the client-side app, there will be a hydration mismatch error. Hydration mismatch is most commonly introduced by the following causes:")]),_v(" "),_m(65),_v(" "),_c('p',[_v("When Vue encounters a hydration mismatch, it will attempt to automatically recover and adjust the pre-rendered DOM to match the client-side state. This will lead to some rendering performance loss due to incorrect nodes being discarded and new nodes being mounted, but in most cases, the app should continue to work as expected. That said, it is still best to eliminate hydration mismatches during development.")]),_v(" "),_m(66),_v(" "),_m(67),_v(" "),_m(68),_m(69),_v(" "),_c('p',[_v("Teleports require special handling during SSR. If the rendered app contains Teleports, the teleported content will not be part of the rendered string. An easier solution is to conditionally render the Teleport on mount.")]),_v(" "),_m(70),_v(" "),_m(71),_c('p',[_v("You need to inject the teleport markup into the correct location in your final page HTML similar to how you need to inject the main app markup.")]),_v(" "),_c('box',{attrs:{"type":"info"}},[_v("\n  Avoid targeting `body` when using Teleports and SSR together - usually, `"),_c('body',[_v("` will contain other server-rendered content which makes it impossible for Teleports to determine the correct starting location for hydration.\n"),_c('p',[_v("Instead, prefer a dedicated container, e.g. "),_c('code',{pre:true,attrs:{"class":"hljs inline no-lang"}},[_v("<div id=\"teleported\"></div>")]),_v(" which contains only teleported content.")])])]),_v(" "),_c('i',{staticClass:"fa fa-arrow-circle-up fa-lg d-print-none",attrs:{"id":"scroll-top-button","onclick":"handleScrollTop()","aria-hidden":"true"}})],1),_v(" "),_c('overlay-source',{attrs:{"id":"page-nav","tag-name":"nav","to":"page-nav"}},[_c('div',{staticClass:"nav-component slim-scroll"})])],1),_v(" "),_m(72)])}
};
    var pageVueStaticRenderFns = [function anonymous(
) {
with(this){return _c('h1',{attrs:{"id":"server-side-rendering-ssr"}},[_c('span',{staticClass:"anchor",attrs:{"id":"server-side-rendering-ssr"}}),_v("Server-Side Rendering (SSR)"),_c('a',{staticClass:"fa fa-anchor",attrs:{"href":"#server-side-rendering-ssr","onclick":"event.stopPropagation()"}})])}
},function anonymous(
) {
with(this){return _c('h2',{attrs:{"id":"overview"}},[_c('span',{staticClass:"anchor",attrs:{"id":"overview"}}),_v("Overview"),_c('a',{staticClass:"fa fa-anchor",attrs:{"href":"#overview","onclick":"event.stopPropagation()"}})])}
},function anonymous(
) {
with(this){return _c('h3',{attrs:{"id":"what-is-ssr"}},[_c('span',{staticClass:"anchor",attrs:{"id":"what-is-ssr"}}),_v("What is SSR?"),_c('a',{staticClass:"fa fa-anchor",attrs:{"href":"#what-is-ssr","onclick":"event.stopPropagation()"}})])}
},function anonymous(
) {
with(this){return _c('p',[_v("A server-rendered Vue.js app can also be considered \"isomorphic\" or \"universal\", in the sense that the majority of your app's code runs on both the server "),_c('strong',[_v("and")]),_v(" the client.")])}
},function anonymous(
) {
with(this){return _c('h3',{attrs:{"id":"why-ssr"}},[_c('span',{staticClass:"anchor",attrs:{"id":"why-ssr"}}),_v("Why SSR?"),_c('a',{staticClass:"fa fa-anchor",attrs:{"href":"#why-ssr","onclick":"event.stopPropagation()"}})])}
},function anonymous(
) {
with(this){return _c('li',[_c('p',[_c('strong',[_v("Faster time-to-content")]),_v(": this is more prominent on slow internet or slow devices. Server-rendered markup doesn't need to wait until all JavaScript has been downloaded and executed to be displayed, so your user will see a fully-rendered page sooner. In addition, data fetching is done on the server-side for the initial visit, which likely has a faster connection to your database than the client. This generally results in improved "),_c('a',{attrs:{"href":"https://web.dev/vitals/"}},[_v("Core Web Vitals")]),_v(" metrics, better user experience, and can be critical for applications where time-to-content is directly associated with conversion rate.")])])}
},function anonymous(
) {
with(this){return _c('li',[_c('p',[_c('strong',[_v("Unified mental model")]),_v(": you get to use the same language and the same declarative, component-oriented mental model for developing your entire app, instead of jumping back and forth between a backend templating system and a frontend framework.")])])}
},function anonymous(
) {
with(this){return _c('p',[_c('strong',[_v("Better SEO")]),_v(": the search engine crawlers will directly see the fully rendered page.")])}
},function anonymous(
) {
with(this){return _c('ul',[_c('li',[_c('p',[_v("Development constraints. Browser-specific code can only be used inside certain lifecycle hooks; some external libraries may need special treatment to be able to run in a server-rendered app.")])]),_v(" "),_c('li',[_c('p',[_v("More involved build setup and deployment requirements. Unlike a fully static SPA that can be deployed on any static file server, a server-rendered app requires an environment where a Node.js server can run.")])]),_v(" "),_c('li',[_c('p',[_v("More server-side load. Rendering a full app in Node.js is going to be more CPU-intensive than just serving static files, so if you expect high traffic, be prepared for corresponding server load and wisely employ caching strategies.")])])])}
},function anonymous(
) {
with(this){return _c('h3',{attrs:{"id":"ssr-vs-ssg"}},[_c('span',{staticClass:"anchor",attrs:{"id":"ssr-vs-ssg"}}),_v("SSR vs. SSG"),_c('a',{staticClass:"fa fa-anchor",attrs:{"href":"#ssr-vs-ssg","onclick":"event.stopPropagation()"}})])}
},function anonymous(
) {
with(this){return _c('p',[_c('strong',[_v("Static Site Generation (SSG)")]),_v(", also referred to as pre-rendering, is another popular technique for building fast websites. If the data needed to server-render a page is the same for every user, then instead of rendering the page every time a request comes in, we can render it only once, ahead of time, during the build process. Pre-rendered pages are generated and served as static HTML files.")])}
},function anonymous(
) {
with(this){return _c('p',[_v("SSG retains the same performance characteristics of SSR apps: it provides great time-to-content performance. At the same time, it is cheaper and easier to deploy than SSR apps because the output is static HTML and assets. The keyword here is "),_c('strong',[_v("static")]),_v(": SSG can only be applied to pages consuming static data, i.e. data that is known at build time and does not change between deploys. Every time the data changes, a new deployment is needed.")])}
},function anonymous(
) {
with(this){return _c('p',[_v("If you're only investigating SSR to improve the SEO of a handful of marketing pages (e.g. "),_c('code',{pre:true,attrs:{"class":"hljs inline no-lang"}},[_v("/")]),_v(", "),_c('code',{pre:true,attrs:{"class":"hljs inline no-lang"}},[_v("/about")]),_v(", "),_c('code',{pre:true,attrs:{"class":"hljs inline no-lang"}},[_v("/contact")]),_v(", etc.), then you probably want SSG instead of SSR. SSG is also great for content-based websites such as documentation sites or blogs. In fact, this website you are reading right now is statically generated using "),_c('a',{attrs:{"href":"https://vitepress.vuejs.org/"}},[_v("VitePress")]),_v(", a Vue-powered static site generator.")])}
},function anonymous(
) {
with(this){return _c('h2',{attrs:{"id":"basic-tutorial"}},[_c('span',{staticClass:"anchor",attrs:{"id":"basic-tutorial"}}),_v("Basic Tutorial"),_c('a',{staticClass:"fa fa-anchor",attrs:{"href":"#basic-tutorial","onclick":"event.stopPropagation()"}})])}
},function anonymous(
) {
with(this){return _c('h3',{attrs:{"id":"rendering-an-app"}},[_c('span',{staticClass:"anchor",attrs:{"id":"rendering-an-app"}}),_v("Rendering an App"),_c('a',{staticClass:"fa fa-anchor",attrs:{"href":"#rendering-an-app","onclick":"event.stopPropagation()"}})])}
},function anonymous(
) {
with(this){return _c('ol',[_c('li',[_v("Create a new directory and "),_c('code',{pre:true,attrs:{"class":"hljs inline no-lang"}},[_v("cd")]),_v(" into it")]),_v(" "),_c('li',[_v("Run "),_c('code',{pre:true,attrs:{"class":"hljs inline no-lang"}},[_v("npm init -y")])]),_v(" "),_c('li',[_v("Add "),_c('code',{pre:true,attrs:{"class":"hljs inline no-lang"}},[_v("\"type\": \"module\"")]),_v(" in "),_c('code',{pre:true,attrs:{"class":"hljs inline no-lang"}},[_v("package.json")]),_v(" so that Node.js runs in "),_c('a',{attrs:{"href":"https://nodejs.org/api/esm.html#modules-ecmascript-modules"}},[_v("ES modules mode")]),_v(".")]),_v(" "),_c('li',[_v("Run "),_c('code',{pre:true,attrs:{"class":"hljs inline no-lang"}},[_v("npm install vue")])]),_v(" "),_c('li',[_v("Create an "),_c('code',{pre:true,attrs:{"class":"hljs inline no-lang"}},[_v("example.js")]),_v(" file:")])])}
},function anonymous(
) {
with(this){return _c('pre',[_c('code',{pre:true,attrs:{"class":"hljs js"}},[_c('span',[_c('span',{pre:true,attrs:{"class":"hljs-comment"}},[_v("// this runs in Node.js on the server.")]),_v("\n")]),_c('span',[_c('span',{pre:true,attrs:{"class":"hljs-keyword"}},[_v("import")]),_v(" { createSSRApp } "),_c('span',{pre:true,attrs:{"class":"hljs-keyword"}},[_v("from")]),_v(" "),_c('span',{pre:true,attrs:{"class":"hljs-string"}},[_v("'vue'")]),_v("\n")]),_c('span',[_c('span',{pre:true,attrs:{"class":"hljs-comment"}},[_v("// Vue's server-rendering API is exposed under `vue/server-renderer`.")]),_v("\n")]),_c('span',[_c('span',{pre:true,attrs:{"class":"hljs-keyword"}},[_v("import")]),_v(" { renderToString } "),_c('span',{pre:true,attrs:{"class":"hljs-keyword"}},[_v("from")]),_v(" "),_c('span',{pre:true,attrs:{"class":"hljs-string"}},[_v("'vue/server-renderer'")]),_v("\n")]),_c('span',[_v("\n")]),_c('span',[_c('span',{pre:true,attrs:{"class":"hljs-keyword"}},[_v("const")]),_v(" app = createSSRApp({\n")]),_c('span',[_v("  "),_c('span',{pre:true,attrs:{"class":"hljs-attr"}},[_v("data")]),_v(": "),_c('span',{pre:true,attrs:{"class":"hljs-function"}},[_v("() =>")]),_v(" ({ "),_c('span',{pre:true,attrs:{"class":"hljs-attr"}},[_v("count")]),_v(": "),_c('span',{pre:true,attrs:{"class":"hljs-number"}},[_v("1")]),_v(" }),\n")]),_c('span',[_v("  "),_c('span',{pre:true,attrs:{"class":"hljs-attr"}},[_v("template")]),_v(": "),_c('span',{pre:true,attrs:{"class":"hljs-string"}},[_v("`<button @click=\"count++\"></button>`")]),_v("\n")]),_c('span',[_v("})\n")]),_c('span',[_v("\n")]),_c('span',[_v("renderToString(app).then("),_c('span',{pre:true,attrs:{"class":"hljs-function"}},[_v("("),_c('span',{pre:true,attrs:{"class":"hljs-params"}},[_v("html")]),_v(") =>")]),_v(" {\n")]),_c('span',[_v("  "),_c('span',{pre:true,attrs:{"class":"hljs-built_in"}},[_v("console")]),_v(".log(html)\n")]),_c('span',[_v("})\n")])])])}
},function anonymous(
) {
with(this){return _c('pre',[_c('code',{pre:true,attrs:{"class":"hljs sh"}},[_c('span',[_v("> node example.js\n")])])])}
},function anonymous(
) {
with(this){return _c('pre',[_c('code',{pre:true,attrs:{"class":"hljs"}},[_c('span',[_v("<button>1</button>\n")])])])}
},function anonymous(
) {
with(this){return _c('p',[_c('a',{attrs:{"href":"/api/ssr.html#rendertostring"}},[_c('code',{pre:true,attrs:{"class":"hljs inline no-lang"}},[_v("renderToString()")])]),_v(" takes a Vue app instance and returns a Promise that resolves to the rendered HTML of the app. It is also possible to stream rendering using the "),_c('a',{attrs:{"href":"https://nodejs.org/api/stream.html"}},[_v("Node.js Stream API")]),_v(" or "),_c('a',{attrs:{"href":"https://developer.mozilla.org/en-US/docs/Web/API/Streams_API"}},[_v("Web Streams API")]),_v(". Check out the "),_c('a',{attrs:{"href":"/api/ssr.html"}},[_v("SSR API Reference")]),_v(" for full details.")])}
},function anonymous(
) {
with(this){return _c('p',[_v("We can then move the Vue SSR code into a server request handler, which wraps the application markup with the full page HTML. We will be using "),_c('a',{attrs:{"href":"https://expressjs.com/"}},[_c('code',{pre:true,attrs:{"class":"hljs inline no-lang"}},[_v("express")])]),_v(" for the next steps:")])}
},function anonymous(
) {
with(this){return _c('ul',[_c('li',[_v("Run "),_c('code',{pre:true,attrs:{"class":"hljs inline no-lang"}},[_v("npm install express")])]),_v(" "),_c('li',[_v("Create the following "),_c('code',{pre:true,attrs:{"class":"hljs inline no-lang"}},[_v("server.js")]),_v(" file:")])])}
},function anonymous(
) {
with(this){return _c('pre',[_c('code',{pre:true,attrs:{"class":"hljs js"}},[_c('span',[_c('span',{pre:true,attrs:{"class":"hljs-keyword"}},[_v("import")]),_v(" express "),_c('span',{pre:true,attrs:{"class":"hljs-keyword"}},[_v("from")]),_v(" "),_c('span',{pre:true,attrs:{"class":"hljs-string"}},[_v("'express'")]),_v("\n")]),_c('span',[_c('span',{pre:true,attrs:{"class":"hljs-keyword"}},[_v("import")]),_v(" { createSSRApp } "),_c('span',{pre:true,attrs:{"class":"hljs-keyword"}},[_v("from")]),_v(" "),_c('span',{pre:true,attrs:{"class":"hljs-string"}},[_v("'vue'")]),_v("\n")]),_c('span',[_c('span',{pre:true,attrs:{"class":"hljs-keyword"}},[_v("import")]),_v(" { renderToString } "),_c('span',{pre:true,attrs:{"class":"hljs-keyword"}},[_v("from")]),_v(" "),_c('span',{pre:true,attrs:{"class":"hljs-string"}},[_v("'vue/server-renderer'")]),_v("\n")]),_c('span',[_v("\n")]),_c('span',[_c('span',{pre:true,attrs:{"class":"hljs-keyword"}},[_v("const")]),_v(" server = express()\n")]),_c('span',[_v("\n")]),_c('span',[_v("server.get("),_c('span',{pre:true,attrs:{"class":"hljs-string"}},[_v("'/'")]),_v(", "),_c('span',{pre:true,attrs:{"class":"hljs-function"}},[_v("("),_c('span',{pre:true,attrs:{"class":"hljs-params"}},[_v("req, res")]),_v(") =>")]),_v(" {\n")]),_c('span',[_v("  "),_c('span',{pre:true,attrs:{"class":"hljs-keyword"}},[_v("const")]),_v(" app = createSSRApp({\n")]),_c('span',[_v("    "),_c('span',{pre:true,attrs:{"class":"hljs-attr"}},[_v("data")]),_v(": "),_c('span',{pre:true,attrs:{"class":"hljs-function"}},[_v("() =>")]),_v(" ({ "),_c('span',{pre:true,attrs:{"class":"hljs-attr"}},[_v("count")]),_v(": "),_c('span',{pre:true,attrs:{"class":"hljs-number"}},[_v("1")]),_v(" }),\n")]),_c('span',[_v("    "),_c('span',{pre:true,attrs:{"class":"hljs-attr"}},[_v("template")]),_v(": "),_c('span',{pre:true,attrs:{"class":"hljs-string"}},[_v("`<button @click=\"count++\"></button>`")]),_v("\n")]),_c('span',[_v("  })\n")]),_c('span',[_v("\n")]),_c('span',[_v("  renderToString(app).then("),_c('span',{pre:true,attrs:{"class":"hljs-function"}},[_v("("),_c('span',{pre:true,attrs:{"class":"hljs-params"}},[_v("html")]),_v(") =>")]),_v(" {\n")]),_c('span',[_v("    res.send("),_c('span',{pre:true,attrs:{"class":"hljs-string"}},[_v("`")]),_v("\n")]),_c('span',[_c('span',{pre:true,attrs:{"class":"hljs-string"}},[_v("    <!DOCTYPE html>")]),_v("\n")]),_c('span',[_c('span',{pre:true,attrs:{"class":"hljs-string"}},[_v("    <html>")]),_v("\n")]),_c('span',[_c('span',{pre:true,attrs:{"class":"hljs-string"}},[_v("      <head>")]),_v("\n")]),_c('span',[_c('span',{pre:true,attrs:{"class":"hljs-string"}},[_v("        <title>Vue SSR Example</title>")]),_v("\n")]),_c('span',[_c('span',{pre:true,attrs:{"class":"hljs-string"}},[_v("      </head>")]),_v("\n")]),_c('span',[_c('span',{pre:true,attrs:{"class":"hljs-string"}},[_v("      <body>")]),_v("\n")]),_c('span',[_c('span',{pre:true,attrs:{"class":"hljs-string"}},[_v("        <div id=\"app\">"),_c('span',{pre:true,attrs:{"class":"hljs-subst"}},[_v("${html}")]),_v("</div>")]),_v("\n")]),_c('span',[_c('span',{pre:true,attrs:{"class":"hljs-string"}},[_v("      </body>")]),_v("\n")]),_c('span',[_c('span',{pre:true,attrs:{"class":"hljs-string"}},[_v("    </html>")]),_v("\n")]),_c('span',[_c('span',{pre:true,attrs:{"class":"hljs-string"}},[_v("    `")]),_v(")\n")]),_c('span',[_v("  })\n")]),_c('span',[_v("})\n")]),_c('span',[_v("\n")]),_c('span',[_v("server.listen("),_c('span',{pre:true,attrs:{"class":"hljs-number"}},[_v("3000")]),_v(", "),_c('span',{pre:true,attrs:{"class":"hljs-function"}},[_v("() =>")]),_v(" {\n")]),_c('span',[_v("  "),_c('span',{pre:true,attrs:{"class":"hljs-built_in"}},[_v("console")]),_v(".log("),_c('span',{pre:true,attrs:{"class":"hljs-string"}},[_v("'ready'")]),_v(")\n")]),_c('span',[_v("})\n")])])])}
},function anonymous(
) {
with(this){return _c('p',[_v("Finally, run "),_c('code',{pre:true,attrs:{"class":"hljs inline no-lang"}},[_v("node server.js")]),_v(" and visit "),_c('code',{pre:true,attrs:{"class":"hljs inline no-lang"}},[_v("http://localhost:3000")]),_v(". You should see the page working with the button.")])}
},function anonymous(
) {
with(this){return _c('p',[_c('a',{attrs:{"href":"https://stackblitz.com/fork/vue-ssr-example-basic?file=index.js"}},[_v("Try it on StackBlitz")])])}
},function anonymous(
) {
with(this){return _c('h3',{attrs:{"id":"client-hydration"}},[_c('span',{staticClass:"anchor",attrs:{"id":"client-hydration"}}),_v("Client Hydration"),_c('a',{staticClass:"fa fa-anchor",attrs:{"href":"#client-hydration","onclick":"event.stopPropagation()"}})])}
},function anonymous(
) {
with(this){return _c('p',[_v("To make the client-side app interactive, Vue needs to perform the "),_c('strong',[_v("hydration")]),_v(" step. During hydration, it creates the same Vue application that was run on the server, matches each component to the DOM nodes it should control, and attaches DOM event listeners.")])}
},function anonymous(
) {
with(this){return _c('p',[_v("To mount an app in hydration mode, we need to use "),_c('a',{attrs:{"href":"/api/application.html#createssrapp"}},[_c('code',{pre:true,attrs:{"class":"hljs inline no-lang"}},[_v("createSSRApp()")])]),_v(" instead of "),_c('code',{pre:true,attrs:{"class":"hljs inline no-lang"}},[_v("createApp()")]),_v(":")])}
},function anonymous(
) {
with(this){return _c('pre',[_c('code',{pre:true,attrs:{"2":"","class":"hljs js"}},[_c('span',[_c('span',{pre:true,attrs:{"class":"hljs-comment"}},[_v("// this runs in the browser.")]),_v("\n")]),_c('span',[_c('span',{pre:true,attrs:{"class":"hljs-keyword"}},[_v("import")]),_v(" { createSSRApp } "),_c('span',{pre:true,attrs:{"class":"hljs-keyword"}},[_v("from")]),_v(" "),_c('span',{pre:true,attrs:{"class":"hljs-string"}},[_v("'vue'")]),_v("\n")]),_c('span',[_v("\n")]),_c('span',[_c('span',{pre:true,attrs:{"class":"hljs-keyword"}},[_v("const")]),_v(" app = createSSRApp({\n")]),_c('span',[_v("  "),_c('span',{pre:true,attrs:{"class":"hljs-comment"}},[_v("// ...same app as on server")]),_v("\n")]),_c('span',[_v("})\n")]),_c('span',[_v("\n")]),_c('span',[_c('span',{pre:true,attrs:{"class":"hljs-comment"}},[_v("// mounting an SSR app on the client assumes")]),_v("\n")]),_c('span',[_c('span',{pre:true,attrs:{"class":"hljs-comment"}},[_v("// the HTML was pre-rendered and will perform")]),_v("\n")]),_c('span',[_c('span',{pre:true,attrs:{"class":"hljs-comment"}},[_v("// hydration instead of mounting new DOM nodes.")]),_v("\n")]),_c('span',[_v("app.mount("),_c('span',{pre:true,attrs:{"class":"hljs-string"}},[_v("'#app'")]),_v(")\n")])])])}
},function anonymous(
) {
with(this){return _c('h3',{attrs:{"id":"code-structure"}},[_c('span',{staticClass:"anchor",attrs:{"id":"code-structure"}}),_v("Code Structure"),_c('a',{staticClass:"fa fa-anchor",attrs:{"href":"#code-structure","onclick":"event.stopPropagation()"}})])}
},function anonymous(
) {
with(this){return _c('p',[_v("Here we will demonstrate the most bare-bones setup. First, let's split the app creation logic into a dedicated file, "),_c('code',{pre:true,attrs:{"class":"hljs inline no-lang"}},[_v("app.js")]),_v(":")])}
},function anonymous(
) {
with(this){return _c('pre',[_c('code',{pre:true,attrs:{"class":"hljs js"}},[_c('span',[_c('span',{pre:true,attrs:{"class":"hljs-comment"}},[_v("// app.js (shared between server and client)")]),_v("\n")]),_c('span',[_c('span',{pre:true,attrs:{"class":"hljs-keyword"}},[_v("import")]),_v(" { createSSRApp } "),_c('span',{pre:true,attrs:{"class":"hljs-keyword"}},[_v("from")]),_v(" "),_c('span',{pre:true,attrs:{"class":"hljs-string"}},[_v("'vue'")]),_v("\n")]),_c('span',[_v("\n")]),_c('span',[_c('span',{pre:true,attrs:{"class":"hljs-keyword"}},[_v("export")]),_v(" "),_c('span',{pre:true,attrs:{"class":"hljs-function"}},[_c('span',{pre:true,attrs:{"class":"hljs-keyword"}},[_v("function")]),_v(" "),_c('span',{pre:true,attrs:{"class":"hljs-title"}},[_v("createApp")]),_v("("),_c('span',{pre:true,attrs:{"class":"hljs-params"}}),_v(") ")]),_v("{\n")]),_c('span',[_v("  "),_c('span',{pre:true,attrs:{"class":"hljs-keyword"}},[_v("return")]),_v(" createSSRApp({\n")]),_c('span',[_v("    "),_c('span',{pre:true,attrs:{"class":"hljs-attr"}},[_v("data")]),_v(": "),_c('span',{pre:true,attrs:{"class":"hljs-function"}},[_v("() =>")]),_v(" ({ "),_c('span',{pre:true,attrs:{"class":"hljs-attr"}},[_v("count")]),_v(": "),_c('span',{pre:true,attrs:{"class":"hljs-number"}},[_v("1")]),_v(" }),\n")]),_c('span',[_v("    "),_c('span',{pre:true,attrs:{"class":"hljs-attr"}},[_v("template")]),_v(": "),_c('span',{pre:true,attrs:{"class":"hljs-string"}},[_v("`<button @click=\"count++\"></button>`")]),_v("\n")]),_c('span',[_v("  })\n")]),_c('span',[_v("}\n")])])])}
},function anonymous(
) {
with(this){return _c('p',[_v("This file and its dependencies are shared between the server and the client - we call them "),_c('strong',[_v("universal code")]),_v(". There are a number of things you need to pay attention to when writing universal code, as we will "),_c('a',{attrs:{"href":"#writing-ssr-friendly-code"}},[_v("discuss below")]),_v(".")])}
},function anonymous(
) {
with(this){return _c('pre',[_c('code',{pre:true,attrs:{"class":"hljs js"}},[_c('span',[_c('span',{pre:true,attrs:{"class":"hljs-comment"}},[_v("// client.js")]),_v("\n")]),_c('span',[_c('span',{pre:true,attrs:{"class":"hljs-keyword"}},[_v("import")]),_v(" { createApp } "),_c('span',{pre:true,attrs:{"class":"hljs-keyword"}},[_v("from")]),_v(" "),_c('span',{pre:true,attrs:{"class":"hljs-string"}},[_v("'./app.js'")]),_v("\n")]),_c('span',[_v("\n")]),_c('span',[_v("createApp().mount("),_c('span',{pre:true,attrs:{"class":"hljs-string"}},[_v("'#app'")]),_v(")\n")])])])}
},function anonymous(
) {
with(this){return _c('pre',[_c('code',{pre:true,attrs:{"2,5":"","class":"hljs js"}},[_c('span',[_c('span',{pre:true,attrs:{"class":"hljs-comment"}},[_v("// server.js (irrelevant code omitted)")]),_v("\n")]),_c('span',[_c('span',{pre:true,attrs:{"class":"hljs-keyword"}},[_v("import")]),_v(" { createApp } "),_c('span',{pre:true,attrs:{"class":"hljs-keyword"}},[_v("from")]),_v(" "),_c('span',{pre:true,attrs:{"class":"hljs-string"}},[_v("'./app.js'")]),_v("\n")]),_c('span',[_v("\n")]),_c('span',[_v("server.get("),_c('span',{pre:true,attrs:{"class":"hljs-string"}},[_v("'/'")]),_v(", "),_c('span',{pre:true,attrs:{"class":"hljs-function"}},[_v("("),_c('span',{pre:true,attrs:{"class":"hljs-params"}},[_v("req, res")]),_v(") =>")]),_v(" {\n")]),_c('span',[_v("  "),_c('span',{pre:true,attrs:{"class":"hljs-keyword"}},[_v("const")]),_v(" app = createApp()\n")]),_c('span',[_v("  renderToString(app).then("),_c('span',{pre:true,attrs:{"class":"hljs-function"}},[_c('span',{pre:true,attrs:{"class":"hljs-params"}},[_v("html")]),_v(" =>")]),_v(" {\n")]),_c('span',[_v("    "),_c('span',{pre:true,attrs:{"class":"hljs-comment"}},[_v("// ...")]),_v("\n")]),_c('span',[_v("  })\n")]),_c('span',[_v("})\n")])])])}
},function anonymous(
) {
with(this){return _c('ol',[_c('li',[_v("Serve client files by adding "),_c('code',{pre:true,attrs:{"class":"hljs inline no-lang"}},[_v("server.use(express.static('.'))")]),_v(" in "),_c('code',{pre:true,attrs:{"class":"hljs inline no-lang"}},[_v("server.js")]),_v(".")]),_v(" "),_c('li',[_v("Load the client entry by adding "),_c('code',{pre:true,attrs:{"class":"hljs inline no-lang"}},[_v("<script type=\"module\" src=\"/client.js\"></script>")]),_v(" to the HTML shell.")]),_v(" "),_c('li',[_v("Support usage like "),_c('code',{pre:true,attrs:{"class":"hljs inline no-lang"}},[_v("import * from 'vue'")]),_v(" in the browser by adding an "),_c('a',{attrs:{"href":"https://github.com/WICG/import-maps"}},[_v("Import Map")]),_v(" to the HTML shell.")])])}
},function anonymous(
) {
with(this){return _c('p',[_c('a',{attrs:{"href":"https://stackblitz.com/fork/vue-ssr-example?file=index.js"}},[_v("Try the completed example on StackBlitz")]),_v(". The button is now interactive!")])}
},function anonymous(
) {
with(this){return _c('h2',{attrs:{"id":"higher-level-solutions"}},[_c('span',{staticClass:"anchor",attrs:{"id":"higher-level-solutions"}}),_v("Higher Level Solutions"),_c('a',{staticClass:"fa fa-anchor",attrs:{"href":"#higher-level-solutions","onclick":"event.stopPropagation()"}})])}
},function anonymous(
) {
with(this){return _c('li',[_c('p',[_v("In the server request handler, render the HTML with the correct client-side asset links and optimal resource hints. We may also need to switch between SSR and SSG mode, or even mix both in the same app.")])])}
},function anonymous(
) {
with(this){return _c('li',[_c('p',[_v("Manage routing, data fetching, and state management stores in a universal manner.")])])}
},function anonymous(
) {
with(this){return _c('h3',{attrs:{"id":"nuxt"}},[_c('span',{staticClass:"anchor",attrs:{"id":"nuxt"}}),_v("Nuxt"),_c('a',{staticClass:"fa fa-anchor",attrs:{"href":"#nuxt","onclick":"event.stopPropagation()"}})])}
},function anonymous(
) {
with(this){return _c('p',[_c('a',{attrs:{"href":"https://nuxt.com/"}},[_v("Nuxt")]),_v(" is a higher-level framework built on top of the Vue ecosystem which provides a streamlined development experience for writing universal Vue applications. Better yet, you can also use it as a static site generator! We highly recommend giving it a try.")])}
},function anonymous(
) {
with(this){return _c('h3',{attrs:{"id":"quasa"}},[_c('span',{staticClass:"anchor",attrs:{"id":"quasa"}}),_v("Quasa"),_c('a',{staticClass:"fa fa-anchor",attrs:{"href":"#quasa","onclick":"event.stopPropagation()"}})])}
},function anonymous(
) {
with(this){return _c('p',[_c('a',{attrs:{"href":"https://quasar.dev"}},[_v("Quasar")]),_v(" is a complete Vue-based solution that allows you to target SPA, SSR, PWA, mobile app, desktop app, and browser extension all using one codebase. It not only handles the build setup, but also provides a full collection of Material Design compliant UI components.")])}
},function anonymous(
) {
with(this){return _c('h3',{attrs:{"id":"vite-ssr"}},[_c('span',{staticClass:"anchor",attrs:{"id":"vite-ssr"}}),_v("Vite SSR"),_c('a',{staticClass:"fa fa-anchor",attrs:{"href":"#vite-ssr","onclick":"event.stopPropagation()"}})])}
},function anonymous(
) {
with(this){return _c('p',[_v("Vite provides built-in "),_c('a',{attrs:{"href":"https://vitejs.dev/guide/ssr.html"}},[_v("support for Vue server-side rendering")]),_v(", but it is intentionally low-level. If you wish to go directly with Vite, check out "),_c('a',{attrs:{"href":"https://vite-plugin-ssr.com/"}},[_v("vite-plugin-ssr")]),_v(", a community plugin that abstracts away many challenging details for you.")])}
},function anonymous(
) {
with(this){return _c('p',[_v("You can also find an example Vue + Vite SSR project using manual setup "),_c('a',{attrs:{"href":"https://github.com/vitejs/vite-plugin-vue/tree/main/playground/ssr-vue"}},[_v("here")]),_v(", which can serve as a base to build upon. Note this is only recommended if you are experienced with SSR / build tools and really want to have complete control over the higher-level architecture.")])}
},function anonymous(
) {
with(this){return _c('h2',{attrs:{"id":"writing-ssr-friendly-code"}},[_c('span',{staticClass:"anchor",attrs:{"id":"writing-ssr-friendly-code"}}),_v("Writing SSR-friendly Code"),_c('a',{staticClass:"fa fa-anchor",attrs:{"href":"#writing-ssr-friendly-code","onclick":"event.stopPropagation()"}})])}
},function anonymous(
) {
with(this){return _c('h3',{attrs:{"id":"reactivity-on-the-server"}},[_c('span',{staticClass:"anchor",attrs:{"id":"reactivity-on-the-server"}}),_v("Reactivity on the Server"),_c('a',{staticClass:"fa fa-anchor",attrs:{"href":"#reactivity-on-the-server","onclick":"event.stopPropagation()"}})])}
},function anonymous(
) {
with(this){return _c('h3',{attrs:{"id":"component-lifecycle-hooks"}},[_c('span',{staticClass:"anchor",attrs:{"id":"component-lifecycle-hooks"}}),_v("Component Lifecycle Hooks"),_c('a',{staticClass:"fa fa-anchor",attrs:{"href":"#component-lifecycle-hooks","onclick":"event.stopPropagation()"}})])}
},function anonymous(
) {
with(this){return _c('p',[_v("Since there are no dynamic updates, lifecycle hooks such as "),_c('span',{staticClass:"options-api"},[_c('code',{pre:true,attrs:{"class":"hljs inline no-lang"}},[_v("mounted")])]),_c('span',{staticClass:"composition-api"},[_c('code',{pre:true,attrs:{"class":"hljs inline no-lang"}},[_v("onMounted")])]),_v(" or "),_c('span',{staticClass:"options-api"},[_c('code',{pre:true,attrs:{"class":"hljs inline no-lang"}},[_v("updated")])]),_c('span',{staticClass:"composition-api"},[_c('code',{pre:true,attrs:{"class":"hljs inline no-lang"}},[_v("onUpdated")])]),_v(" will "),_c('strong',[_v("NOT")]),_v(" be called during SSR and will only be executed on the client."),_c('span',{staticClass:"options-api"},[_v(" The only hooks that are called during SSR are "),_c('code',{pre:true,attrs:{"class":"hljs inline no-lang"}},[_v("beforeCreate")]),_v(" and "),_c('code',{pre:true,attrs:{"class":"hljs inline no-lang"}},[_v("created")])])])}
},function anonymous(
) {
with(this){return _c('p',[_v("You should avoid code that produces side effects that need cleanup in "),_c('span',{staticClass:"options-api"},[_c('code',{pre:true,attrs:{"class":"hljs inline no-lang"}},[_v("beforeCreate")]),_v(" and "),_c('code',{pre:true,attrs:{"class":"hljs inline no-lang"}},[_v("created")])]),_c('span',{staticClass:"composition-api"},[_c('code',{pre:true,attrs:{"class":"hljs inline no-lang"}},[_v("setup()")]),_v(" or the root scope of "),_c('code',{pre:true,attrs:{"class":"hljs inline no-lang"}},[_v("<script setup>")])]),_v(". An example of such side effects is setting up timers with "),_c('code',{pre:true,attrs:{"class":"hljs inline no-lang"}},[_v("setInterval")]),_v(". In client-side only code we may setup a timer and then tear it down in "),_c('span',{staticClass:"options-api"},[_c('code',{pre:true,attrs:{"class":"hljs inline no-lang"}},[_v("beforeUnmount")])]),_c('span',{staticClass:"composition-api"},[_c('code',{pre:true,attrs:{"class":"hljs inline no-lang"}},[_v("onBeforeUnmount")])]),_v(" or "),_c('span',{staticClass:"options-api"},[_c('code',{pre:true,attrs:{"class":"hljs inline no-lang"}},[_v("unmounted")])]),_c('span',{staticClass:"composition-api"},[_c('code',{pre:true,attrs:{"class":"hljs inline no-lang"}},[_v("onUnmounted")])]),_v(". However, because the unmount hooks will never be called during SSR, the timers will stay around forever. To avoid this, move your side-effect code into "),_c('span',{staticClass:"options-api"},[_c('code',{pre:true,attrs:{"class":"hljs inline no-lang"}},[_v("mounted")])]),_c('span',{staticClass:"composition-api"},[_c('code',{pre:true,attrs:{"class":"hljs inline no-lang"}},[_v("onMounted")])]),_v(" instead.")])}
},function anonymous(
) {
with(this){return _c('h3',{attrs:{"id":"access-to-platform-specific-apis"}},[_c('span',{staticClass:"anchor",attrs:{"id":"access-to-platform-specific-apis"}}),_v("Access to Platform-Specific APIs"),_c('a',{staticClass:"fa fa-anchor",attrs:{"href":"#access-to-platform-specific-apis","onclick":"event.stopPropagation()"}})])}
},function anonymous(
) {
with(this){return _c('p',[_v("Universal code cannot assume access to platform-specific APIs, so if your code directly uses browser-only globals like "),_c('code',{pre:true,attrs:{"class":"hljs inline no-lang"}},[_v("window")]),_v(" or "),_c('code',{pre:true,attrs:{"class":"hljs inline no-lang"}},[_v("document")]),_v(", they will throw errors when executed in Node.js, and vice-versa.")])}
},function anonymous(
) {
with(this){return _c('p',[_v("For tasks that are shared between server and client but with different platform APIs, it's recommended to wrap the platform-specific implementations inside a universal API, or use libraries that do this for you. For example, you can use "),_c('a',{attrs:{"href":"https://github.com/node-fetch/node-fetch"}},[_c('code',{pre:true,attrs:{"class":"hljs inline no-lang"}},[_v("node-fetch")])]),_v(" to use the same fetch API on both server and client.")])}
},function anonymous(
) {
with(this){return _c('p',[_v("For browser-only APIs, the common approach is to lazily access them inside client-only lifecycle hooks such as "),_c('span',{staticClass:"options-api"},[_c('code',{pre:true,attrs:{"class":"hljs inline no-lang"}},[_v("mounted")])]),_c('span',{staticClass:"composition-api"},[_c('code',{pre:true,attrs:{"class":"hljs inline no-lang"}},[_v("onMounted")])]),_v(".")])}
},function anonymous(
) {
with(this){return _c('p',[_v("Note that if a third-party library is not written with universal usage in mind, it could be tricky to integrate it into a server-rendered app. You "),_c('em',[_v("might")]),_v(" be able to get it working by mocking some of the globals, but it would be hacky and may interfere with the environment detection code of other libraries.")])}
},function anonymous(
) {
with(this){return _c('h3',{attrs:{"id":"cross-request-state-pollution"}},[_c('span',{staticClass:"anchor",attrs:{"id":"cross-request-state-pollution"}}),_v("Cross-Request State Pollution"),_c('a',{staticClass:"fa fa-anchor",attrs:{"href":"#cross-request-state-pollution","onclick":"event.stopPropagation()"}})])}
},function anonymous(
) {
with(this){return _c('p',[_v("In the State Management chapter, we introduced a "),_c('a',{attrs:{"href":"/docs/scaling-up/state-management.html#simple-state-management-with-reactivity-api"}},[_v("simple state management pattern using Reactivity APIs")]),_v(". In an SSR context, this pattern requires some additional adjustments.")])}
},function anonymous(
) {
with(this){return _c('p',[_v("The pattern declares shared state in a JavaScript module's root scope. This makes them "),_c('strong',[_v("singletons")]),_v(" - i.e. there is only one instance of the reactive object throughout the entire lifecycle of our application. This works as expected in a pure client-side Vue application, since the modules in our application are initialized fresh for each browser page visit.")])}
},function anonymous(
) {
with(this){return _c('p',[_v("However, in an SSR context, the application modules are typically initialized only once on the server, when the server boots up. The same module instances will be reused across multiple server requests, and so will our singleton state objects. If we mutate the shared singleton state with data specific to one user, it can be accidentally leaked to a request from another user. We call this "),_c('strong',[_v("cross-request state pollution.")])])}
},function anonymous(
) {
with(this){return _c('p',[_v("The recommended solution is to create a new instance of the entire application - including the router and global stores - on each request. Then, instead of directly importing it in our components, we provide the shared state using "),_c('a',{attrs:{"href":"/guide/components/provide-inject.html#app-level-provide"}},[_v("app-level provide")]),_v(" and inject it in components that need it:")])}
},function anonymous(
) {
with(this){return _c('pre',[_c('code',{pre:true,attrs:{"class":"hljs js"}},[_c('span',[_c('span',{pre:true,attrs:{"class":"hljs-comment"}},[_v("// app.js (shared between server and client)")]),_v("\n")]),_c('span',[_c('span',{pre:true,attrs:{"class":"hljs-keyword"}},[_v("import")]),_v(" { createSSRApp } "),_c('span',{pre:true,attrs:{"class":"hljs-keyword"}},[_v("from")]),_v(" "),_c('span',{pre:true,attrs:{"class":"hljs-string"}},[_v("'vue'")]),_v("\n")]),_c('span',[_c('span',{pre:true,attrs:{"class":"hljs-keyword"}},[_v("import")]),_v(" { createStore } "),_c('span',{pre:true,attrs:{"class":"hljs-keyword"}},[_v("from")]),_v(" "),_c('span',{pre:true,attrs:{"class":"hljs-string"}},[_v("'./store.js'")]),_v("\n")]),_c('span',[_v("\n")]),_c('span',[_c('span',{pre:true,attrs:{"class":"hljs-comment"}},[_v("// called on each request")]),_v("\n")]),_c('span',[_c('span',{pre:true,attrs:{"class":"hljs-keyword"}},[_v("export")]),_v(" "),_c('span',{pre:true,attrs:{"class":"hljs-function"}},[_c('span',{pre:true,attrs:{"class":"hljs-keyword"}},[_v("function")]),_v(" "),_c('span',{pre:true,attrs:{"class":"hljs-title"}},[_v("createApp")]),_v("("),_c('span',{pre:true,attrs:{"class":"hljs-params"}}),_v(") ")]),_v("{\n")]),_c('span',[_v("  "),_c('span',{pre:true,attrs:{"class":"hljs-keyword"}},[_v("const")]),_v(" app = createSSRApp("),_c('span',{pre:true,attrs:{"class":"hljs-comment"}},[_v("/* ... */")]),_v(")\n")]),_c('span',[_v("  "),_c('span',{pre:true,attrs:{"class":"hljs-comment"}},[_v("// create new instance of store per request")]),_v("\n")]),_c('span',[_v("  "),_c('span',{pre:true,attrs:{"class":"hljs-keyword"}},[_v("const")]),_v(" store = createStore("),_c('span',{pre:true,attrs:{"class":"hljs-comment"}},[_v("/* ... */")]),_v(")\n")]),_c('span',[_v("  "),_c('span',{pre:true,attrs:{"class":"hljs-comment"}},[_v("// provide store at the app level")]),_v("\n")]),_c('span',[_v("  app.provide("),_c('span',{pre:true,attrs:{"class":"hljs-string"}},[_v("'store'")]),_v(", store)\n")]),_c('span',[_v("  "),_c('span',{pre:true,attrs:{"class":"hljs-comment"}},[_v("// also expose store for hydration purposes")]),_v("\n")]),_c('span',[_v("  "),_c('span',{pre:true,attrs:{"class":"hljs-keyword"}},[_v("return")]),_v(" { app, store }\n")]),_c('span',[_v("}\n")])])])}
},function anonymous(
) {
with(this){return _c('p',[_v("State Management libraries like Pinia are designed with this in mind. Consult "),_c('a',{attrs:{"href":"https://pinia.vuejs.org/ssr/"}},[_v("Pinia's SSR guide")]),_v(" for more details.")])}
},function anonymous(
) {
with(this){return _c('h3',{attrs:{"id":"hydration-mismatch"}},[_c('span',{staticClass:"anchor",attrs:{"id":"hydration-mismatch"}}),_v("Hydration Mismatch"),_c('a',{staticClass:"fa fa-anchor",attrs:{"href":"#hydration-mismatch","onclick":"event.stopPropagation()"}})])}
},function anonymous(
) {
with(this){return _c('ol',[_c('li',[_c('p',[_v("The template contains invalid HTML nesting structure, and the rendered HTML got \"corrected\" by the browser's native HTML parsing behavior. For example, a common gotcha is that "),_c('a',{attrs:{"href":"https://stackoverflow.com/questions/8397852/why-cant-the-p-tag-contain-a-div-tag-inside-it"}},[_c('code',{pre:true,attrs:{"class":"hljs inline no-lang"}},[_v("<div>")]),_v(" cannot be placed inside "),_c('code',{pre:true,attrs:{"class":"hljs inline no-lang"}},[_v("<p>")])]),_v(":")]),_v(" "),_c('pre',[_c('code',{pre:true,attrs:{"class":"hljs html"}},[_c('span',[_c('span',{pre:true,attrs:{"class":"hljs-tag"}},[_v("<"),_c('span',{pre:true,attrs:{"class":"hljs-name"}},[_v("p")]),_v(">")]),_c('span',{pre:true,attrs:{"class":"hljs-tag"}},[_v("<"),_c('span',{pre:true,attrs:{"class":"hljs-name"}},[_v("div")]),_v(">")]),_v("hi"),_c('span',{pre:true,attrs:{"class":"hljs-tag"}},[_v("</"),_c('span',{pre:true,attrs:{"class":"hljs-name"}},[_v("div")]),_v(">")]),_c('span',{pre:true,attrs:{"class":"hljs-tag"}},[_v("</"),_c('span',{pre:true,attrs:{"class":"hljs-name"}},[_v("p")]),_v(">")]),_v("\n")])])]),_c('p',[_v("If we produce this in our server-rendered HTML, the browser will terminate the first "),_c('code',{pre:true,attrs:{"class":"hljs inline no-lang"}},[_v("<p>")]),_v(" when "),_c('code',{pre:true,attrs:{"class":"hljs inline no-lang"}},[_v("<div>")]),_v(" is encountered and parse it into the following DOM structure:")]),_v(" "),_c('pre',[_c('code',{pre:true,attrs:{"class":"hljs html"}},[_c('span',[_c('span',{pre:true,attrs:{"class":"hljs-tag"}},[_v("<"),_c('span',{pre:true,attrs:{"class":"hljs-name"}},[_v("p")]),_v(">")]),_c('span',{pre:true,attrs:{"class":"hljs-tag"}},[_v("</"),_c('span',{pre:true,attrs:{"class":"hljs-name"}},[_v("p")]),_v(">")]),_v("\n")]),_c('span',[_c('span',{pre:true,attrs:{"class":"hljs-tag"}},[_v("<"),_c('span',{pre:true,attrs:{"class":"hljs-name"}},[_v("div")]),_v(">")]),_v("hi"),_c('span',{pre:true,attrs:{"class":"hljs-tag"}},[_v("</"),_c('span',{pre:true,attrs:{"class":"hljs-name"}},[_v("div")]),_v(">")]),_v("\n")]),_c('span',[_c('span',{pre:true,attrs:{"class":"hljs-tag"}},[_v("<"),_c('span',{pre:true,attrs:{"class":"hljs-name"}},[_v("p")]),_v(">")]),_c('span',{pre:true,attrs:{"class":"hljs-tag"}},[_v("</"),_c('span',{pre:true,attrs:{"class":"hljs-name"}},[_v("p")]),_v(">")]),_v("\n")])])])]),_v(" "),_c('li',[_c('p',[_v("The data used during render contains randomly generated values. Since the same application will run twice - once on the server, and once on the client - the random values are not guaranteed to be the same between the two runs. There are two ways to avoid random-value-induced mismatches:")]),_v(" "),_c('ol',[_c('li',[_c('p',[_v("Use "),_c('code',{pre:true,attrs:{"class":"hljs inline no-lang"}},[_v("v-if")]),_v(" + "),_c('code',{pre:true,attrs:{"class":"hljs inline no-lang"}},[_v("onMounted")]),_v(" to render the part that depends on random values only on the client. Your framework may also have built-in features to make this easier, for example the "),_c('code',{pre:true,attrs:{"class":"hljs inline no-lang"}},[_v("<ClientOnly>")]),_v(" component in VitePress.")])]),_v(" "),_c('li',[_c('p',[_v("Use a random number generator library that supports generating with seeds, and guarantee the server run and the client run are using the same seed (e.g. by including the seed in serialized state and retrieving it on the client).")])])])]),_v(" "),_c('li',[_c('p',[_v("The server and the client are in different time zones. Sometimes, we may want to convert a timestamp into the user's local time. However, the timezone during the server run and the timezone during the client run are not always the same, and we may not reliably know the user's timezone during the server run. In such cases, the local time conversion should also be performed as a client-only operation.")])])])}
},function anonymous(
) {
with(this){return _c('h3',{attrs:{"id":"custom-directives"}},[_c('span',{staticClass:"anchor",attrs:{"id":"custom-directives"}}),_v("Custom Directives"),_c('a',{staticClass:"fa fa-anchor",attrs:{"href":"#custom-directives","onclick":"event.stopPropagation()"}})])}
},function anonymous(
) {
with(this){return _c('p',[_v("Since most custom directives involve direct DOM manipulation, they are ignored during SSR. However, if you want to specify how a custom directive should be rendered (i.e. what attributes it should add to the rendered element), you can use the "),_c('code',{pre:true,attrs:{"class":"hljs inline no-lang"}},[_v("getSSRProps")]),_v(" directive hook:")])}
},function anonymous(
) {
with(this){return _c('pre',[_c('code',{pre:true,attrs:{"class":"hljs js"}},[_c('span',[_c('span',{pre:true,attrs:{"class":"hljs-keyword"}},[_v("const")]),_v(" myDirective = {\n")]),_c('span',[_v("  "),_c('span',{pre:true,attrs:{"class":"hljs-function"}},[_c('span',{pre:true,attrs:{"class":"hljs-title"}},[_v("mounted")]),_v("("),_c('span',{pre:true,attrs:{"class":"hljs-params"}},[_v("el, binding")]),_v(")")]),_v(" {\n")]),_c('span',[_v("    "),_c('span',{pre:true,attrs:{"class":"hljs-comment"}},[_v("// client-side implementation:")]),_v("\n")]),_c('span',[_v("    "),_c('span',{pre:true,attrs:{"class":"hljs-comment"}},[_v("// directly update the DOM")]),_v("\n")]),_c('span',[_v("    el.id = binding.value\n")]),_c('span',[_v("  },\n")]),_c('span',[_v("  "),_c('span',{pre:true,attrs:{"class":"hljs-function"}},[_c('span',{pre:true,attrs:{"class":"hljs-title"}},[_v("getSSRProps")]),_v("("),_c('span',{pre:true,attrs:{"class":"hljs-params"}},[_v("binding")]),_v(")")]),_v(" {\n")]),_c('span',[_v("    "),_c('span',{pre:true,attrs:{"class":"hljs-comment"}},[_v("// server-side implementation:")]),_v("\n")]),_c('span',[_v("    "),_c('span',{pre:true,attrs:{"class":"hljs-comment"}},[_v("// return the props to be rendered.")]),_v("\n")]),_c('span',[_v("    "),_c('span',{pre:true,attrs:{"class":"hljs-comment"}},[_v("// getSSRProps only receives the directive binding.")]),_v("\n")]),_c('span',[_v("    "),_c('span',{pre:true,attrs:{"class":"hljs-keyword"}},[_v("return")]),_v(" {\n")]),_c('span',[_v("      "),_c('span',{pre:true,attrs:{"class":"hljs-attr"}},[_v("id")]),_v(": binding.value\n")]),_c('span',[_v("    }\n")]),_c('span',[_v("  }\n")]),_c('span',[_v("}\n")])])])}
},function anonymous(
) {
with(this){return _c('h3',{attrs:{"id":"teleports"}},[_c('span',{staticClass:"anchor",attrs:{"id":"teleports"}}),_v("Teleports"),_c('a',{staticClass:"fa fa-anchor",attrs:{"href":"#teleports","onclick":"event.stopPropagation()"}})])}
},function anonymous(
) {
with(this){return _c('p',[_v("If you do need to hydrate teleported content, they are exposed under the "),_c('code',{pre:true,attrs:{"class":"hljs inline no-lang"}},[_v("teleports")]),_v(" property of the ssr context object:")])}
},function anonymous(
) {
with(this){return _c('pre',[_c('code',{pre:true,attrs:{"class":"hljs js"}},[_c('span',[_c('span',{pre:true,attrs:{"class":"hljs-keyword"}},[_v("const")]),_v(" ctx = {}\n")]),_c('span',[_c('span',{pre:true,attrs:{"class":"hljs-keyword"}},[_v("const")]),_v(" html = "),_c('span',{pre:true,attrs:{"class":"hljs-keyword"}},[_v("await")]),_v(" renderToString(app, ctx)\n")]),_c('span',[_v("\n")]),_c('span',[_c('span',{pre:true,attrs:{"class":"hljs-built_in"}},[_v("console")]),_v(".log(ctx.teleports) "),_c('span',{pre:true,attrs:{"class":"hljs-comment"}},[_v("// { '#teleported': 'teleported content' }")]),_v("\n")])])])}
},function anonymous(
) {
with(this){return _c('footer',[_c('div',{staticClass:"text-center"},[_c('small',[_v("[Generated by "),_c('a',{attrs:{"href":"https://markbind.org/"}},[_v("MarkBind 4.0.2")]),_v("]")])])])}
}];
  